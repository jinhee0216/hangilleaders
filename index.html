<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>한길 경영지원센터 정책자금 신청</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .form-section { margin-bottom: 20px; }
        .required::after { content: '*'; color: red; margin-left: 5px; }
        #success-message, #error-message { display: none; text-align: center; }
        button { padding: 10px 20px; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>한길 경영지원센터 정책자금 신청</h1>
    <p>이 폼을 사용하려면 JavaScript를 활성화해야 합니다.</p>

    <form id="policy-fund-form">
        <div class="form-section">
            <label for="name" class="required">대표자명</label>
            <input type="text" id="name" name="entry.496355609" required>
        </div>

        <div class="form-section">
            <label for="birth" class="required">생년월일</label>
            <input type="text" id="birth" name="entry.1381543198" placeholder="예: 871221-1" required>
            <p>생년월일을 올바른 형식(예: 871221-1)으로 입력하세요.</p>
        </div>

        <div class="form-section">
            <label for="phone" class="required">연락처</label>
            <div>
                <input type="text" id="phone" name="entry.1777400821" placeholder="예: 010-1234-5678" required>
            </div>
            <p>연락처를 올바른 형식(예: 010-0000-0000)으로 입력해주세요.</p>
        </div>

        <div class="form-section">
            <label for="business_type" class="required">사업자 형태</label>
            <div>
                <label><input type="radio" name="entry.1848392224" value="개인 사업자" required> 개인 사업자</label>
                <label><input type="radio" name="entry.1848392224" value="법인 사업자"> 법인 사업자</label>
            </div>
        </div>

        <div class="form-section">
            <label for="business_name" class="required">상호명</label>
            <input type="text" id="business_name" name="entry.320957289" required>
        </div>

        <div class="form-section">
            <label for="business_number" class="required">사업자 번호</label>
            <input type="text" id="business_number" name="entry.1258798604" required>
        </div>

        <div class="form-section">
            <label for="establish_date" class="required">개업년월(설립일)</label>
            <input type="text" id="establish_date" name="entry.1645878600" required>
        </div>

        <div class="form-section">
            <label for="business_location" class="required">사업장 소재지</label>
            <input type="text" id="business_location" name="entry.235646697" required>
        </div>

        <div class="form-section">
            <label for="shareholder">주주관계 (법인 사업자의 경우)</label>
            <input type="text" id="shareholder" name="entry.1948797116">
        </div>

        <div class="form-section">
            <label for="industry">사업 업종</label>
            <input type="text" id="industry" name="entry.1861900902">
        </div>

        <div class="form-section">
            <label for="industry_detail">업종 상세</label>
            <input type="text" id="industry_detail" name="entry.1581719321">
        </div>

        <div class="form-section">
            <label for="export">수출 여부 (제조업종의 경우)</label>
            <select id="export" name="entry.708691363">
                <option value="">선택하세요</option>
                <option value="예">예</option>
                <option value="아니오">아니오</option>
            </select>
        </div>

        <div class="form-section">
            <label for="last_year_sales" class="required">작년 연매출</label>
            <input type="text" id="last_year_sales" name="entry.881899480" required>
        </div>

        <div class="form-section">
            <label for="avg_monthly_sales" class="required">평균 월매출</label>
            <input type="text" id="avg_monthly_sales" name="entry.1421429286" required>
        </div>

        <div class="form-section">
            <label for="employee_count" class="required">직원수</label>
            <input type="number" id="employee_count" name="entry.520614711" required>
        </div>

        <div class="form-section">
            <label for="credit_score" class="required">NICE / KCB 신용점수</label>
            <input type="text" id="credit_score" name="entry.973911698" required>
        </div>

        <div class="form-section">
            <label for="loan_amount" class="required">기대출금액</label>
            <input type="text" id="loan_amount" name="entry.1117371473" required>
        </div>

        <div class="form-section">
            <label for="delinquency" class="required">연체·체납 여부</label>
            <input type="text" id="delinquency" name="entry.1384962675" required>
        </div>

        <div class="form-section">
            <label for="policy_fund_usage" class="required">정책자금 이용여부</label>
            <input type="text" id="policy_fund_usage" name="entry.1646538138" required>
        </div>

        <div class="form-section">
            <label for="required_amount">필요금액 및 용도</label>
            <textarea id="required_amount" name="entry.44687952"></textarea>
        </div>

        <div class="form-section">
            <p>
                <a href="https://edu.semac.or.kr" target="_blank">지식배움터 바로가기</a> ㅣ 
                <span>지식배움터 제출사유</span>
            </p>
            <div>
                <label for="edu_id">지식배움터 ID</label>
                <input type="text" id="edu_id" name="entry.653096036">
            </div>
            <div>
                <label for="edu_pw">지식배움터 PW</label>
                <input type="password" id="edu_pw" name="entry.936679548">
            </div>
            <p>
                <a href="https://www.semas.or.kr" target="_blank">소상공인 정책자금 바로가기</a> ㅣ 
                <span>소상공인 정책자금 제출사유</span>
            </p>
            <div>
                <label for="policy_id">소상공인정책자금 ID</label>
                <input type="text" id="policy_id" name="entry.6599574">
            </div>
            <div>
                <label for="policy_pw">소상공인정책자금 PW</label>
                <input type="password" id="policy_pw" name="entry.1803670926">
            </div>
        </div>

        <div class="form-section">
            <label>
                <input type="checkbox" id="privacy_agree" name="entry.1234567914" required>
                개인정보 처리방침에 동의합니다. (필수)
            </label>
        </div>

        <div class="form-section">
            <label>
                <input type="checkbox" id="marketing_agree" name="entry.1234567915">
                마케팅 정보 수신(이벤트, 광고성 정보 등)에 동의합니다. (선택)
            </label>
        </div>

        <button type="submit">제출</button>
    </form>

    <div id="success-message">
        <h2>신청서 접수가 완료되었습니다.</h2>
        <p>감사합니다. 제출해주신 내용 확인 후 담당자가 연락드리겠습니다.</p>
        <p>제출된 데이터를 확인하려면 <a href="https://docs.google.com/spreadsheets/d/1IASjA5fBtr9iMvxmIbLoG3ExmXRm86kKphMuUuTvUck/edit" target="_blank">여기</a>를 클릭하세요.</p>
        <button onclick="window.location.href='index.html'">돌아가기</button>
    </div>

    <div id="error-message">
        <h2>제출에 실패했습니다.</h2>
        <p id="error-details">입력 데이터를 확인하시고 다시 시도해 주세요.</p>
        <button onclick="document.getElementById('error-message').style.display='none'; document.getElementById('policy-fund-form').style.display='block';">다시 시도</button>
    </div>

    <p>* 개인정보는 서비스 제공, 회원 관리, 마케팅 목적으로 수집되며, 관련 법령에 따라 일정 기간(예: 상거래 기록 5년, 본인확인 기록 6개월) 보관 후 파기됩니다.</p>

    <script>
        // 폼 제출 처리 스크립트
        document.querySelector('#policy-fund-form').addEventListener('submit', (e) => {
            e.preventDefault(); // 기본 제출 방지

            // 입력 데이터 유효성 검사
            const phone = document.querySelector('#phone').value;
            if (!phone.match(/^\d{3}-\d{4}-\d{4}$/)) {
                showError('연락처 형식이 잘못되었습니다. 예: 010-1234-5678');
                return;
            }

            const birth = document.querySelector('#birth').value;
            if (!birth.match(/^\d{6}-[1-4]$/)) {
                showError('생년월일 형식이 잘못되었습니다. 예: 871221-1');
                return;
            }

            const businessNumber = document.querySelector('#business_number').value;
            if (!businessNumber.match(/^\d{3}-\d{2}-\d{5}$/)) {
                showError('사업자 번호 형식이 잘못되었습니다. 예: 111-11-11111');
                return;
            }

            // 필수 항목 체크
            const requiredFields = [
                'name', 'birth', 'phone', 'business_name', 'business_number', 
                'establish_date', 'business_location', 'last_year_sales', 
                'avg_monthly_sales', 'employee_count', 'credit_score', 
                'loan_amount', 'delinquency', 'policy_fund_usage'
            ];
            for (const field of requiredFields) {
                const input = document.querySelector(`#${field}`);
                if (!input.value) {
                    showError('모든 필수 항목을 입력해주세요.');
                    return;
                }
            }

            // 사업자 형태 라디오 버튼 체크
            if (!document.querySelector('input[name="entry.1848392224"]:checked')) {
                showError('사업자 형태를 선택해주세요.');
                return;
            }

            // 개인정보 동의 체크
            if (!document.querySelector('#privacy_agree').checked) {
                showError('개인정보 처리방침에 동의해야 합니다.');
                return;
            }

            // Google Forms로 제출
            fetch('https://docs.google.com/forms/d/e/1FAIpQLSfCCx_nkF5we_NAOxebUj17EKV5zIjRzDTmptQBtvpmtSbE5Q/formResponse', {
                method: 'POST',
                body: new FormData(document.querySelector('#policy-fund-form')),
                mode: 'no-cors' // CORS 문제 방지
            })
            .then(() => {
                // 성공 처리 (no-cors 모드에서는 응답 본문을 읽을 수 없으므로 요청 완료만 확인)
                document.querySelector('#success-message').style.display = 'block';
                document.querySelector('#policy-fund-form').style.display = 'none';
                document.querySelector('#policy-fund-form').reset();
            })
            .catch(error => {
                console.error('제출 오류:', error);
                showError('네트워크 문제로 제출에 실패했습니다. 인터넷 연결을 확인 후 다시 시도해주세요.');
            });
        });

        // 에러 메시지 표시 함수
        function showError(message) {
            document.querySelector('#error-details').textContent = message;
            document.querySelector('#error-message').style.display = 'block';
            document.querySelector('#policy-fund-form').style.display = 'none';
        }
    </script>
</body>
</html>
